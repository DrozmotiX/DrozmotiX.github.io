<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Proxmox (LXC) | DrozmotiX | Adapter Documentation</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="An overview of my open source software projects">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    
    <link rel="preload" href="/assets/css/0.styles.910d7109.css" as="style"><link rel="preload" href="/assets/js/app.eed03126.js" as="script"><link rel="preload" href="/assets/js/2.b011b8af.js" as="script"><link rel="preload" href="/assets/js/36.2807c03d.js" as="script"><link rel="prefetch" href="/assets/js/10.e3007c24.js"><link rel="prefetch" href="/assets/js/11.927e7cc3.js"><link rel="prefetch" href="/assets/js/12.ff1883a4.js"><link rel="prefetch" href="/assets/js/13.7d0afbf2.js"><link rel="prefetch" href="/assets/js/14.eeb4da23.js"><link rel="prefetch" href="/assets/js/15.0f35023d.js"><link rel="prefetch" href="/assets/js/16.0eaf1fa8.js"><link rel="prefetch" href="/assets/js/17.4e69bea2.js"><link rel="prefetch" href="/assets/js/18.a508d84d.js"><link rel="prefetch" href="/assets/js/19.56a8d89d.js"><link rel="prefetch" href="/assets/js/20.0db104b9.js"><link rel="prefetch" href="/assets/js/21.8cdd319f.js"><link rel="prefetch" href="/assets/js/22.bf959202.js"><link rel="prefetch" href="/assets/js/23.41eb0f7e.js"><link rel="prefetch" href="/assets/js/24.d3c74bd3.js"><link rel="prefetch" href="/assets/js/25.9744fa53.js"><link rel="prefetch" href="/assets/js/26.620763d1.js"><link rel="prefetch" href="/assets/js/27.2f0dc09d.js"><link rel="prefetch" href="/assets/js/28.06b26e56.js"><link rel="prefetch" href="/assets/js/29.bac43ded.js"><link rel="prefetch" href="/assets/js/3.350ac8ac.js"><link rel="prefetch" href="/assets/js/30.2a198248.js"><link rel="prefetch" href="/assets/js/31.8f991dca.js"><link rel="prefetch" href="/assets/js/32.09d203c7.js"><link rel="prefetch" href="/assets/js/33.d4510ea7.js"><link rel="prefetch" href="/assets/js/34.135f0203.js"><link rel="prefetch" href="/assets/js/35.3f35e1e8.js"><link rel="prefetch" href="/assets/js/37.701df3e0.js"><link rel="prefetch" href="/assets/js/38.c94df6b5.js"><link rel="prefetch" href="/assets/js/39.bf266808.js"><link rel="prefetch" href="/assets/js/4.05f6e18f.js"><link rel="prefetch" href="/assets/js/40.ac668536.js"><link rel="prefetch" href="/assets/js/41.2efdc621.js"><link rel="prefetch" href="/assets/js/42.36c3b96e.js"><link rel="prefetch" href="/assets/js/43.9ae42092.js"><link rel="prefetch" href="/assets/js/44.e740f3bc.js"><link rel="prefetch" href="/assets/js/45.24eebdba.js"><link rel="prefetch" href="/assets/js/46.b25d67fc.js"><link rel="prefetch" href="/assets/js/47.ad48fc98.js"><link rel="prefetch" href="/assets/js/48.911bf381.js"><link rel="prefetch" href="/assets/js/49.e636401b.js"><link rel="prefetch" href="/assets/js/5.a94fd944.js"><link rel="prefetch" href="/assets/js/50.865e37e3.js"><link rel="prefetch" href="/assets/js/51.4365af04.js"><link rel="prefetch" href="/assets/js/52.a62c853e.js"><link rel="prefetch" href="/assets/js/6.4008d62c.js"><link rel="prefetch" href="/assets/js/7.8e75ccdc.js"><link rel="prefetch" href="/assets/js/8.8833f1e3.js"><link rel="prefetch" href="/assets/js/9.aaed480a.js">
    <link rel="stylesheet" href="/assets/css/0.styles.910d7109.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">DrozmotiX | Adapter Documentation</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Language Menu" class="dropdown-title"><span class="title">Adapter</span> <span class="arrow down"></span></button> <button type="button" aria-label="Language Menu" class="mobile-dropdown-title"><span class="title">Adapter</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/languages/en/_Overview/" class="nav-link">
  Overview
</a></li><li class="dropdown-item"><!----> <a href="/languages/en/ESPHome/" class="nav-link">
  ESPHome
</a></li><li class="dropdown-item"><!----> <a href="/languages/en/Klipper-Moonraker/" class="nav-link">
  Klipper-Moonraker
</a></li><li class="dropdown-item"><!----> <a href="/languages/en/SourceAnalytix/" class="nav-link">
  SourceAnalytix
</a></li><li class="dropdown-item"><!----> <a href="/languages/en/Tado/" class="nav-link">
  Tado
</a></li></ul></div></div><div class="nav-item"><a href="http://paypal.me/DutchmanNL" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Support Me
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">Languages</span> <span class="arrow down"></span></button> <button type="button" aria-label="Select language" class="mobile-dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/languages/en/BasicSetup/03.ProxmoxLXC.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  English
</a></li><li class="dropdown-item"><!----> <a href="/languages/de/" class="nav-link">
  Deutsch
</a></li></ul></div></div> <a href="https://github.com/DrozmotiX/documentation" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Language Menu" class="dropdown-title"><span class="title">Adapter</span> <span class="arrow down"></span></button> <button type="button" aria-label="Language Menu" class="mobile-dropdown-title"><span class="title">Adapter</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/languages/en/_Overview/" class="nav-link">
  Overview
</a></li><li class="dropdown-item"><!----> <a href="/languages/en/ESPHome/" class="nav-link">
  ESPHome
</a></li><li class="dropdown-item"><!----> <a href="/languages/en/Klipper-Moonraker/" class="nav-link">
  Klipper-Moonraker
</a></li><li class="dropdown-item"><!----> <a href="/languages/en/SourceAnalytix/" class="nav-link">
  SourceAnalytix
</a></li><li class="dropdown-item"><!----> <a href="/languages/en/Tado/" class="nav-link">
  Tado
</a></li></ul></div></div><div class="nav-item"><a href="http://paypal.me/DutchmanNL" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Support Me
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">Languages</span> <span class="arrow down"></span></button> <button type="button" aria-label="Select language" class="mobile-dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/languages/en/BasicSetup/03.ProxmoxLXC.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  English
</a></li><li class="dropdown-item"><!----> <a href="/languages/de/" class="nav-link">
  Deutsch
</a></li></ul></div></div> <a href="https://github.com/DrozmotiX/documentation" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><a href="/languages/en/_Overview/" class="sidebar-link">Overview</a></li><li><section class="sidebar-group collapsable depth-0"><a href="/languages/en/BasicSetup/" class="sidebar-heading clickable router-link-active open"><span>BasicSetup</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/languages/en/BasicSetup/02.BareMetal.html" class="sidebar-link">Bare Metal</a></li><li><a href="/languages/en/BasicSetup/03.ProxmoxLXC.html" aria-current="page" class="active sidebar-link">Proxmox (LXC)</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/languages/en/BasicSetup/03.ProxmoxLXC.html#what-is-lxc" class="sidebar-link">What is LXC ?</a></li><li class="sidebar-sub-header"><a href="/languages/en/BasicSetup/03.ProxmoxLXC.html#basic-setup" class="sidebar-link">Basic setup</a></li><li class="sidebar-sub-header"><a href="/languages/en/BasicSetup/03.ProxmoxLXC.html#mount-usb-devices" class="sidebar-link">Mount USB-Devices</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/languages/en/BasicSetup/03.ProxmoxLXC.html#creating-symbolic-links-of-physical-devices" class="sidebar-link">Creating symbolic links of physical devices</a></li><li class="sidebar-sub-header"><a href="/languages/en/BasicSetup/03.ProxmoxLXC.html#ensure-correct-acl-on-mounted-drive" class="sidebar-link">Ensure correct ACL on mounted drive</a></li><li class="sidebar-sub-header"><a href="/languages/en/BasicSetup/03.ProxmoxLXC.html#mount-device-into-lxc" class="sidebar-link">Mount device into LXC</a></li></ul></li></ul></li><li><a href="/languages/en/BasicSetup/04.ProxmoxVM.html" class="sidebar-link">Proxmox (VM)</a></li><li><a href="/languages/en/BasicSetup/05.Docker.html" class="sidebar-link">Docker</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/languages/en/ESPHome/" class="sidebar-heading clickable"><span>ESPHome</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/languages/en/Klipper-Moonraker/" class="sidebar-heading clickable"><span>Klipper-Moonraker</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/languages/en/SourceAnalytix/" class="sidebar-heading clickable"><span>SourceAnalytix</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/languages/en/Tado/" class="sidebar-heading clickable"><span>Tado</span> <span class="arrow right"></span></a> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="proxmox-lxc"><a href="#proxmox-lxc" class="header-anchor">#</a> Proxmox (LXC)</h1> <p>Proxmox VE is an open-source server management platform for your enterprise virtualization. It tightly integrates KVM hypervisor and LXC, software-defined storage, and networking functionality on a single platform. With the integrated web-based user interface you can easily manage VMs and containers, highly available clusters, or the integrated disaster recovery tools with ease.</p> <h2 id="what-is-lxc"><a href="#what-is-lxc" class="header-anchor">#</a> What is LXC ?</h2> <p>Containers are a lightweight alternative to fully virtualized machines (VMs). They use the kernel of the host system that they run on, instead of emulating a full operating system (OS). This means that containers can access resources on the host system directly.<br>
The runtime costs for containers is low, usually negligible. However, there are some drawbacks that need be considered:</p> <ul><li>Only Linux distributions can be run in Proxmox Containers. It is not possible to run other operating systems like, for example, FreeBSD or Microsoft Windows inside a container.</li> <li>For security reasons, access to host resources needs to be restricted. Therefore, containers run in their own separate namespaces. Additionally some syscalls (user space requests to the Linux kernel) are not allowed within containers.</li></ul> <h2 id="basic-setup"><a href="#basic-setup" class="header-anchor">#</a> Basic setup</h2> <p>&lt;<strong>ToDo</strong>&gt;</p> <h2 id="mount-usb-devices"><a href="#mount-usb-devices" class="header-anchor">#</a> Mount USB-Devices</h2> <p>To ensure USB-DEvinces (like zigbee stick) can be used within the LXC, we need to:</p> <ol><li>Ensure the device is always mounted into the sae directory</li> <li>Ensure the mount directly is writable</li> <li>Forward the ports to the LXC container</li></ol> <p>To accomplish 1 &amp; 2 we will use udev-rules to assign un-mutable TTY names to USB devices by creating symbolic links of physical devices.<br>
As last step we modify the container configuration to accomplish mount the host symbolic link into the container.</p> <h3 id="creating-symbolic-links-of-physical-devices"><a href="#creating-symbolic-links-of-physical-devices" class="header-anchor">#</a> Creating symbolic links of physical devices</h3> <ol><li>Identify the vendor and product id, assuming the device is currently mounted to <code>/dev/ttyACM0</code> use the following commmmand</li></ol> <div class="language- extra-class"><pre class="language-text"><code>udevadm info -a -p $(udevadm info -q path -n /dev/ttyACM0) | grep &quot;ATTRS{idVendor}&quot;  &amp;&amp; udevadm info -a -p $(udevadm info -q path -n /dev/ttyACM0) | grep &quot;ATTRS{idProduct}&quot;
</code></pre></div><p>*Replace <code>/dev/ttyACM0</code> wih the proper mount point if needed</p> <ol start="2"><li>You should see something like this, we always need the values at the top!</li></ol> <div class="language- extra-class"><pre class="language-text"><code>ATTRS{idVendor}==&quot;0451&quot;
ATTRS{idVendor}==&quot;1d6b&quot;
ATTRS{idProduct}==&quot;16c8&quot;
ATTRS{idProduct}==&quot;0002&quot;
</code></pre></div><ol start="3"><li>create new udev-rule <code>nano /etc/udev/rules.d/49-custom.rules</code> and enter the following lines</li></ol> <div class="language- extra-class"><pre class="language-text"><code>KERNEL==&quot;ttyACM[0-9]*&quot;, SUBSYSTEM==&quot;tty&quot;, ATTRS{idVendor}==&quot;0451&quot;, ATTRS{idProduct}==&quot;16c8&quot;, SYMLINK=&quot;ttyZigbee&quot;
</code></pre></div><p>Replace the following items with the previous retrieved values and choose a SYMLINK</p> <ul><li>idVendor <code>Retrieved in step 2</code></li> <li>idProduct <code>Retrieved in step 2</code></li> <li>SYMLINK  <code>The wanted mounting point, usually ttyACM0</code></li></ul> <h3 id="ensure-correct-acl-on-mounted-drive"><a href="#ensure-correct-acl-on-mounted-drive" class="header-anchor">#</a> Ensure correct ACL on mounted drive</h3> <ol><li>Open the previous created udev-rule
<code>nano /etc/udev/rules.d/49-custom.rules</code></li> <li>Add the following line to ensure the ACL is set to 0666<div class="language- extra-class"><pre class="language-text"><code>SUBSYSTEMS==&quot;usb&quot;, ATTRS{idVendor}==&quot;0451&quot;, ATTRS{idProduct}==&quot;16c8&quot;, GROUP=&quot;users&quot;, MODE=&quot;0666&quot;
</code></pre></div></li></ol> <p>Ensure <strong>idVendor</strong> and <strong>idProduct</strong> is provided correctly (See previous step), reboot your machine or reload <code>udev</code> rules:<br> <code>udevadm control --reload</code></p> <h3 id="mount-device-into-lxc"><a href="#mount-device-into-lxc" class="header-anchor">#</a> Mount device into LXC</h3> <ol start="3"><li>Mount the new created symlink into your lxc dev container
<ol><li>Get the ACL group ID of created symlink <code>ls -l /dev/ttyZigbee</code>
in my case the ID is <strong>7</strong>, see the number between user and date<br> <code>lrwxrwxrwx 1 root root 7 Mar 10 13:40 /dev/ttyZigbee -&gt; ttyACM0</code></li> <li>Open the LXC configuration file</li> <li>add the following lines, replace <strong>7</strong> with the number in step 1 and ensure proper symlink directory</li></ol> <div class="language- extra-class"><pre class="language-text"><code>lxc.cgroup.devices.allow: c 7:* rwm
lxc.mount.entry: /dev/ttyZigbee dev/ttyZigbee none bind,optional,create=file
</code></pre></div></li></ol></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/DrozmotiX/documentation/edit/main/src/languages/en/BasicSetup/03.ProxmoxLXC.md" target="_blank" rel="noopener noreferrer">You can help us by editing this page hier</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">3/24/2021, 7:59:55 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/languages/en/BasicSetup/02.BareMetal.html" class="prev">
        Bare Metal
      </a></span> <span class="next"><a href="/languages/en/BasicSetup/04.ProxmoxVM.html">
        Proxmox (VM)
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.eed03126.js" defer></script><script src="/assets/js/2.b011b8af.js" defer></script><script src="/assets/js/36.2807c03d.js" defer></script>
  </body>
</html>
